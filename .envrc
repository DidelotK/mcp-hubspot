#!/bin/bash

# HubSpot MCP Server - direnv configuration
# This file automatically loads environment variables when entering the directory

# Check if environment file exists
if [ -f "deploy/environment" ]; then
    echo "üîß Loading environment variables from deploy/environment..."
    set -a  # automatically export all variables
    source deploy/environment
    set +a  # stop auto-export
    echo "‚úÖ Environment variables loaded successfully!"
    echo "üìã Current configuration:"
    echo "   - IMAGE_TAG: ${IMAGE_TAG:-not set}"
    echo "   - IMAGE_REGISTRY: ${IMAGE_REGISTRY:-not set}" 
    echo "   - NAMESPACE: ${NAMESPACE:-not set}"
    echo "   - DOMAIN: ${DOMAIN:-not set}"
else
    echo "‚ö†Ô∏è  Environment file not found!"
    echo ""
    echo "üìù To set up your environment:"
    echo "   1. Copy the example file:"
    echo "      cp deploy/environment.example deploy/environment"
    echo ""
    echo "   2. Edit deploy/environment with your values:"
    echo "      - Set REGISTRY_PASSWORD to your Scaleway registry password"
    echo "      - Set HUBSPOT_API_KEY to your HubSpot API key"
    echo "      - Set MCP_AUTH_KEY to a secure authentication key"
    echo "      - Update IMAGE_TAG if needed (current default: 1.0.0)"
    echo "      - Configure other variables as needed"
    echo ""
    echo "   3. Run 'direnv allow' to reload this configuration"
    echo ""
    echo "‚ö†Ô∏è  Important: Never commit the deploy/environment file (it contains secrets)"
    echo ""
    echo "üí° For HubSpot API key:"
    echo "   1. Go to HubSpot Settings > Integrations > Private Apps"
    echo "   2. Create a new private app or use existing one"
    echo "   3. Required scopes: Contacts, Companies, Deals (Read access)"
fi

# HubSpot MCP Server Configuration
# 
# Pour obtenir votre cl√© API HubSpot :
# 1. Connectez-vous √† votre compte HubSpot
# 2. Allez dans Settings > Integrations > Private Apps
# 3. Cr√©ez une nouvelle application priv√©e ou utilisez une existante
# 4. Copiez la cl√© API et remplacez "YOUR_HUBSPOT_API_KEY" ci-dessous
#
# Permissions requises :
# - Contacts: Read
# - Companies: Read  
# - Deals: Read
# - CRM Search: Read

export HUBSPOT_API_KEY="REDACTED_HUBSPOT_API_KEY"

# Node.js configuration for MCP compatibility
export PATH="/home/kdidelot/.nvm/versions/node/v20.19.2/bin:$PATH" 